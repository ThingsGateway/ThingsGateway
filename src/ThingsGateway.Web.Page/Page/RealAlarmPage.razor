@*
//------------------------------------------------------------------------------
//  此代码版权声明为全文件覆盖，如有原作者特别声明，会在下方手动补充
//  此代码版权（除特别声明外的代码）归作者本人Diego所有
//  源代码使用协议遵循本仓库的开源协议及附加协议
//  Gitee源代码仓库：https://gitee.com/diego2098/ThingsGateway
//  Github源代码仓库：https://github.com/kimdiego2098/ThingsGateway
//  使用文档：https://diego2098.gitee.io/thingsgateway-docs/
//  QQ群：605534569
//------------------------------------------------------------------------------
*@

@page "/tgruntime/realalarm"
@namespace ThingsGateway.Web.Page
@using System.Linq.Expressions;
@using BlazorComponent;
@using Furion.DataValidation;
@using Mapster;
@using Masa.Blazor.Presets;
@using System.IO;
@using TouchSocket.Core;
@attribute [Authorize]
@inject MasaBlazor MasaBlazor
@attribute [RolePermission]
@inherits CultureComponentBase
@inject UserResoures UserResoures
@layout MainLayout
<AppDataTable @ref="_datatable" TItem="HistoryAlarm" SearchItem="VariablePageInput"
              AddItem="object" EditItem="object" ShowSelect=false
              IsMenuOperTemplate=false SearchModel="_searchModel"
              QueryCall="QueryCall"
              FilterHeaders="FilterHeaders" Filters="Filters" ShowDetailButton
                ShowQueryButton>
    <SearchTemplate>
        <MTextField Dense Style="max-width:200px;" HideDetails=@("auto") Class="my-1  mx-2 " @bind-Value="context.Name" Clearable
                        Outlined Label=@context.Description(x => x.Name) />
        <MTextField Dense Style="max-width:200px;" HideDetails=@("auto") Class="my-1  mx-2 " @bind-Value="context.DeviceName" Clearable
                        Outlined Label=@context.Description(x => x.DeviceName) />
    </SearchTemplate>
    <OtherToolbarTemplate>
        <EnableSwitch Dense=false Class="my-1  mx-3 " @bind-Value=@IsAutoQuery EnabledLabel=@T("自动刷新") DisabledLabel=@T("取消自动刷新") />
    </OtherToolbarTemplate>

    <ItemColTemplate>
        @if (context.Header.Value == nameof(context.Item.IsOnline))
        {
            <EnableChip Value="context.Item.IsOnline" DisabledLabel="离线" EnabledLabel="在线">
            </EnableChip>
        }
        else if (context?.Value?.GetType() == typeof(DateTime))
        {
            <span>
                @(((DateTime)context.Value).Add(JsInitVariables.TimezoneOffset).ToString("yyyy-MM-dd HH:mm:ss ffffff"))
            </span>
        }
        else
        {
            @context.Value

        }

    </ItemColTemplate>

</AppDataTable>



